<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/android-chrome-256x256.png">
  <title>TGIF Members</title>
</head>

<body>
  <div class="container">
    <div id="topLogo">
      <img src="/logo.png" width="60" height="60">TGIF
    </div>
    <div id="textSenate">  
      <p><br><br>
      First convened in 1789, the composition and powers of the Senate are established 
      in Article One of the U.S. Constitution. Each state is represented by two senators, 
      regardless of population, who serve staggered six-year terms. The Senate has 
      several exclusive powers not granted to the House, including consenting to 
      treaties as a precondition to their ratification and consenting to or confirming 
      appointments of Cabinet secretaries, federal judges, other federal executive 
      officials, military officers, regulatory officials, ambassadors, and other federal 
      uniformed officers, as well as trial of federal officials impeached by the House.
      </p>
      <h1>Senators</h1><br>
    </div>
    <div id="textHouse">  
      <p><br><br>
      The major power of the House is to pass federal legislation that affects the entire country, 
      although its bills must also be passed by the Senate and further agreed to by the U.S. President 
      before becoming law (unless both the House and Senate re-pass the legislation with a two-thirds majority
      in each chamber). The House has some exclusive powers: the power to initiate revenue bills, to impeach
      officials (impeached officials are subsequently tried in the Senate), and to elect the U.S. President in
      case there is no majority in the Electoral College. <br>
      Each U.S. state is represented in the House in proportion to its population as measured in the census, but every state is entitled to at least one representative.
      </p>
      <h1>Representatives</h1><br>
    </div>

    <!---- we create the checkboxes--------------------------------------------------------------->
    <div>
      <div class="form-check form-check-inline">
      <label class="form-check-label" for="inlineCheckbox1">Filter by Party: </label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" id="democratFilterCheckbox" value="D" checked > <!-- value => short name-->
      <label class="form-check-label1" for="democratFilterCheckbox" id="grey">Democrat</label> <!-- label = long name-->
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" id="republicanFilterCheckbox" value="R" checked>
      <label class="form-check-label2" for="republicanFilterCheckbox" id="grey">Republican</label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" id="independentFilterCheckbox" value="ID"checked >
      <label class="form-check-label3" for="independentFilterCheckbox" id="grey" >Independent</label>
    </div>
 
   
    <!---------we create menu desplegable--------------------------------------------------------------->
    <div class="form-check form-check-inline">
      <label>Filter by State:</label>
    </div>
    <div class="form-check form-check-inline">
      <select class="form-select form-select-sm" aria-label=".form-select-sm example" id="menu">
         <!-- we create the body with "my script"-->
      </select> 
    </div>
  </div>
    <!---- we create thetable-------------------------------------------------------------------->
    <table class="table table-striped table-bordered">
      <thead>
        <tr> 
          <th>Name</th>
          <th>Party</th>
          <th>State</th>
          <th>Years in Office</th>
          <th>% Votes with Party</th>
        </tr>
      </thead>
      <tbody id="mytable">
       <!-- we create the body with "my script"-->
      </tbody>
    </table>
 
    <!-- script bootstrap --------------------------------------------------------------------->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
    </script> 
    
    <script>
    // --- Seleccionar chamber -----------------------------
    
    //location.assign("http://another.site"); // load another page
    //members.html?chamber=senate
    //members.html?chamber=house
    //http://127.0.0.1:5500/members.html?chamber=senate

    

    // ------------- Función para saber que Party esta seleccionado-----------------------------------------------------------------------------------------------------------------
    function checkboxes_selected(){
    const parties = {
      democrat: 'D',
      republican: 'R',
      independent: 'ID'
    }
    let result=[];
    if (document.querySelector('#democratFilterCheckbox').checked){  result.push(parties.democrat);  }
    if (document.querySelector('#republicanFilterCheckbox').checked){  result.push(parties.republican);  }
    if (document.querySelector('#independentFilterCheckbox').checked){  result.push(parties.independent);  }
    return result;
    }

     // ------------- Función para saber que State esta seleccionado-----------------------------------------------------------------------------------------------------------------
    function menu_selected(){
    let state=document.getElementById("menu").value; 
     // retorno la abreviación que es lo que se muestra en la tabla
    return state; 
    }
    </script>
  
    <!---Función para mostrar en pantalla----------------------------------------------------------------------->  
    <script type="module">
    const check1=document.getElementById("democratFilterCheckbox");
    const check2=document.getElementById("republicanFilterCheckbox");
    const check3=document.getElementById("independentFilterCheckbox");
    const state=document.getElementById("menu");
 
    import { fetchJson,makeStatesMenu,makeMemberRows} from './scripts/html.js';

      
    fetchJson("/src/states_titlecase.json")
      .then ((datos)=>{
        document.querySelector('#menu').innerHTML=makeStatesMenu(datos)
      })
    
    
    // debemos saber que chamber hemos puesto en la URL
    const params = new URL(document.location).searchParams;
    const chamber=params.get("chamber")
    console.log('la variable chamber es:',chamber)
    selectChamberandChangetheText(chamber);  // llamamos a la función para saber que chamber hemos puesto
    
    function selectChamberandChangetheText(chamber){
      let file='';
      if(chamber=="house"){ // debemos coger los datos de "congress-117-house.json y ocultar texto de Senate"
        document.querySelector('#textSenate').style.display="none";
        file="/src/congress-117-house.json";
      }
      else// debemos coger los datos de "congress-117-senate.json y ocultar texto de House"
      {
        document.querySelector('#textHouse').style.display="none";
        file="/src/congress-117-senate.json";
      }
      
      return file; // nos devuelve el fichero que debemos pasar al fetchJson
    }
    
    let fileJson=selectChamberandChangetheText(chamber)
    console.log('el parametro que pasamos es',fileJson)

    fetchJson(fileJson)
      .then((datos)=>{
        function filter_table(){
          menu_selected();
          console.log('checked',checkboxes_selected())
          document.querySelector('#mytable').innerHTML=makeMemberRows(datos,checkboxes_selected(),menu_selected());
        }
      menu.addEventListener("change",filter_table)
      check1.addEventListener("click",filter_table)
      check2.addEventListener("click",filter_table)
      check3.addEventListener("click",filter_table)

      filter_table();
    })

    </script>
    <footer>
      <p>&copy; 2021 TGIF | All Rights Reserved</p>
    </footer>
  </div>
</body>
</html>





