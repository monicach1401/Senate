<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/android-chrome-256x256.png">
  <title>TGIF Members</title>
</head>
<header>
  <!-- Navigation -->
    <nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-primary" >
      <div class="container">
        <a  href="#" class="navbar-brand mb-0 h1"><img class="d-inline-block align-top" src="/images/logo.png" alt="" width="40" height="40" >
          TGIF</a>
         <!-- creamos el boton del menú para cuando se adapta a diferentes dispositivos-->    
        <button 
          type="button" 
          data-bs-toggle="collapse" 
          data-bs-target="#navbarNav" 
          class="navbar-toggler" 
          aria-controls="navbarNav" 
          aria-expanded="false" 
          aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span> <!-- aqui se pone el icono o un nombre si queremos-->
        </button>
        <!------------------------------------------------------------------------------->  
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a href="/index.html" class="nav-link" aria-current="page" >Home</a>
            </li>
            <li class="nav-item dropdown"> <!-- indicamos que este item va a contener otro menu-->
              <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
               Congres 117
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="/members.html?chamber=senate" class="dropdown-item">Senate</a></li>
                <li><a href="/members.html?chamber=house" class="dropdown-item">House</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown"> <!-- indicamos que este item va a contener otro menu-->
              <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
               Attendance
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="/attendance.html?chamber=senate" class="dropdown-item">Senate</a></li>
                <li><a href="/attendance.html?chamber=house" class="dropdown-item">House</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown"> <!-- indicamos que este item va a contener otro menu-->
              <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
               Loyalty
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="/loyalty.html?chamber=senate" class="dropdown-item">Senate</a></li>
                <li><a href="/loyalty.html?chamber=house" class="dropdown-item">House</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>    
    </nav>
</header>

<body style="background-color: beige">
  <div class="container">
    <div id="textSenate">
      <div class="row">
        <div class="col">
          <img src="/images/img_senate.jpg" style="margin-top: 70px; margin-bottom:5px" >
        </div>
        <div class="col"> 
          <h1 class="fw-bold"style="margin-top: 70px;margin-bottom:5px">Senators</h1>
          <p>
          First convened in 1789, the composition and powers of the Senate are established 
          in Article One of the U.S. Constitution. Each state is represented by two senators, 
          regardless of population, who serve staggered six-year terms. The Senate has 
          several exclusive powers not granted to the House, including consenting to 
          treaties as a precondition to their ratification and consenting to or confirming 
          appointments of Cabinet secretaries, federal judges, other federal executive 
          officials, military officers, regulatory officials, ambassadors, and other federal 
          uniformed officers, as well as trial of federal officials impeached by the House.
          </p>
        </div>
      </div>
    </div>  
    <div id="textHouse">
      <div class="row">
        <div class="col">
          <img src="/images/img_house.jpg" style="margin-top: 70px; margin-bottom:5px">
        </div>
        <div class="col">
          <h1 class="fw-bold" style="margin-top: 70px; margin-bottom:5px">Representatives</h1>
          <p>
            The major power of the House is to pass federal legislation that affects the entire country, 
            although its bills must also be passed by the Senate and further agreed to by the U.S. President 
            before becoming law (unless both the House and Senate re-pass the legislation with a two-thirds majority
            in each chamber). The House has some exclusive powers: the power to initiate revenue bills, to impeach
            officials (impeached officials are subsequently tried in the Senate), and to elect the U.S. President in
            case there is no majority in the Electoral College. <br>
            Each U.S. state is represented in the House in proportion to its population as measured in the census, but every state is entitled to at least one representative.
          </p>
        </div>
      </div>
    </div>  
    
 
    
    <!---- we create the checkboxes--------------------------------------------------------------->
    <div  style="background-color:lightgrey;" >
      <div class="form-check form-check-inline">
      <label class="form-check-label" for="inlineCheckbox1">Filter by Party: </label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" id="democratFilterCheckbox" value="D" checked > <!-- value => short name-->
      <label class="form-check-label1" for="democratFilterCheckbox" id="grey">Democrat</label> <!-- label = long name-->
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" id="republicanFilterCheckbox" value="R" checked>
      <label class="form-check-label2" for="republicanFilterCheckbox" id="grey">Republican</label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" id="independentFilterCheckbox" value="ID"checked >
      <label class="form-check-label3" for="independentFilterCheckbox" id="grey" >Independent</label>
    </div>
       
    <!---------we create menu desplegable--------------------------------------------------------------->
    <div class="form-check form-check-inline">
      <label>Filter by State:</label>
    </div>
    <div class="form-check form-check-inline">
      <select class="form-select form-select-sm" aria-label=".form-select-sm example" id="menu">
         <!-- we create the body with "my script"-->
      </select> 
    </div>
  </div>
    <!---- we create thetable-------------------------------------------------------------------->
    <table class="table table-striped table-bordered ">
      <thead>
        <tr style="background-color:gray"> 
          <th>Name</th>
          <th>Party</th>
          <th>State</th>
          <th>Years in Office</th>
          <th>% Votes with Party</th>
        </tr>
      </thead>
      <tbody id="mytable">
       <!-- we create the body with "my script"-->
      </tbody>
    </table>
 
    <!-- script bootstrap --------------------------------------------------------------------->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
    </script> 
    
    <script>
     activeCurrentLink()

    // función para activar la página en la que estamos//
    function activeCurrentLink(){
      console.log(window.location.href)
      var element=window.document.querySelector('#navbarDropdown') // le indicamos que estamos en Congress
      element.classList.toggle("active") 
    }
    
    
    

    // ------------- Función para saber que Party esta seleccionado-----------------------------------------------------------------------------------------------------------------
    function checkboxes_selected(){
    const parties = {
      democrat: 'D',
      republican: 'R',
      independent: 'ID'
    }
    let result=[];
    if (document.querySelector('#democratFilterCheckbox').checked){  result.push(parties.democrat);  }
    if (document.querySelector('#republicanFilterCheckbox').checked){  result.push(parties.republican);  }
    if (document.querySelector('#independentFilterCheckbox').checked){  result.push(parties.independent);  }
    return result;
    }

     // ------------- Función para saber que State esta seleccionado-----------------------------------------------------------------------------------------------------------------
    function menu_selected(){
    let state=document.getElementById("menu").value; 
     // retorno la abreviación que es lo que se muestra en la tabla
    return state; 
    }
    </script>
  
    <!---Función para mostrar en pantalla----------------------------------------------------------------------->  
    <script type="module">
    const check1=document.getElementById("democratFilterCheckbox");
    const check2=document.getElementById("republicanFilterCheckbox");
    const check3=document.getElementById("independentFilterCheckbox");
    const state=document.getElementById("menu");
 
    import { fetchJson,makeStatesMenu,makeMemberRows} from './scripts/html.js';

      
    fetchJson("/data/states_titlecase.json")
      .then ((datos)=>{
        document.querySelector('#menu').innerHTML=makeStatesMenu(datos)
      })
    
    
    // debemos saber que chamber hemos puesto en la URL
    const params = new URL(document.location).searchParams;
    const chamber=params.get("chamber")
    console.log('la variable chamber es:',chamber)
    selectChamberandChangetheText(chamber);  // llamamos a la función para saber que chamber hemos puesto
    
    function selectChamberandChangetheText(chamber){
      let file='';
      if(chamber=="house"){ // debemos coger los datos de "congress-117-house.json y ocultar texto de Senate"
        document.querySelector('#textSenate').style.display="none";
        file="/data/congress-117-house.json";
      }
      else// debemos coger los datos de "congress-117-senate.json y ocultar texto de House"
      {
        document.querySelector('#textHouse').style.display="none";
        file="/data/congress-117-senate.json";
      }
      
      return file; // nos devuelve el fichero que debemos pasar al fetchJson
    }
    
    let fileJson=selectChamberandChangetheText(chamber)
    console.log('el parametro que pasamos es',fileJson)

    fetchJson(fileJson)
      .then((datos)=>{
        addnewObject(datos) // añadimos un nuevo objecto 
        function addnewObject(){
         datos.senate=new Object();
         datos.house =new Object();
         console.log(datos)
        }
        function filter_table(){
          menu_selected();
          console.log('checked',checkboxes_selected())
          document.querySelector('#mytable').innerHTML=makeMemberRows(datos,checkboxes_selected(),menu_selected());
        }
      menu.addEventListener("change",filter_table)
      check1.addEventListener("click",filter_table)
      check2.addEventListener("click",filter_table)
      check3.addEventListener("click",filter_table)

      filter_table();
    })

    </script>
    <footer>
      <p>&copy; 2021 TGIF | All Rights Reserved</p>
    </footer>
  </div>
</body>
</html>





